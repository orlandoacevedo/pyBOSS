#!/usr/bin/env python3

CHARGES = """
    0.123782  -0.324020  -0.122514  -0.131094  -0.122398  -0.090627  -0.110795
    -0.107795  -0.041283  -0.098389  -0.241108   0.113690   0.114137   0.111586
    0.105579   0.109568   0.110946   0.103171   0.110094   0.112362   0.090699
    0.091562   0.092955

    0.122793  -0.322451  -0.121568  -0.131891  -0.122996  -0.090563  -0.111474
    -0.108143  -0.040175  -0.098441  -0.241206   0.113707   0.114313   0.111413
    0.105496   0.109418   0.110772   0.103276   0.109582   0.112461   0.090926
    0.091736   0.093112

    0.124772  -0.325553  -0.123412  -0.130339  -0.121828  -0.090694  -0.110096
    -0.107458  -0.042398  -0.098372  -0.240998   0.113674   0.113972   0.111752
    0.105660   0.109709   0.111120   0.103070   0.110615   0.112263   0.090474
    0.091390   0.092802

    0.124797  -0.320762  -0.121065  -0.133664  -0.123672  -0.090254  -0.112776
    -0.107529  -0.038181  -0.096673  -0.242665   0.112526   0.112165   0.110528
    0.105264   0.107832   0.110736   0.103664   0.110450   0.113311   0.090810
    0.092258   0.093002

    0.123793  -0.319168  -0.120057  -0.134552  -0.124202  -0.090206  -0.113394
    -0.107885  -0.037166  -0.096861  -0.242717   0.112570   0.112333   0.110353
    0.105208   0.107696   0.110576   0.103770   0.109958   0.113393   0.091045
    0.092422   0.093169

    0.125799  -0.322316  -0.122021  -0.132820  -0.123172  -0.090307  -0.112144
    -0.107186  -0.039201  -0.096515  -0.242603   0.112487   0.112005   0.110695
    0.105320   0.107958   0.110894   0.103561   0.110954   0.113225   0.090575
    0.092096   0.092837

    0.126463  -0.320251  -0.121674  -0.134125  -0.124033  -0.090544  -0.113859
    -0.108134  -0.036782  -0.096564  -0.242767   0.112546   0.112390   0.110540
    0.105149   0.107685   0.110377   0.104068   0.110581   0.113237   0.090625
    0.092046   0.093157

    0.125436  -0.318698  -0.120657  -0.134998  -0.124536  -0.090489  -0.114427
    -0.108505  -0.035805  -0.096829  -0.242796   0.112595   0.112564   0.110369
    0.105100   0.107560   0.110224   0.104176   0.110103   0.113309   0.090867
    0.092206   0.093330

    0.127494   -0.321761   -0.122651   -0.133295   -0.123559   -0.090604
    -0.113277   -0.107778   -0.037763   -0.096331   -0.242731    0.112499
    0.112223    0.110701    0.105197    0.107801    0.110527    0.103964
    0.111068    0.113162    0.090386    0.091888    0.092987
"""


DATA = """
# -290649.9454773242343
 6 -0.00000  0.00000  0.00000
 8  0.19506  0.05794 -1.25583
 6  0.30010  2.19852 -1.83485
 6  1.30120  2.64810 -1.01314
 6  0.98926  2.73216  0.38995
 6  0.94617  0.61147  0.97376
 6  0.60811  0.47186  2.36875
 6 -1.24058 -0.56946  0.52038
 6 -0.51801 -0.18663  2.74129
 6 -1.44566 -0.65830  1.85712
 6 -0.78721 -0.40616  4.18386
 1 -0.76147  2.31920 -1.57881
 1  0.49202  2.02941 -2.89853
 1  2.35015  2.70232 -1.33484
 1  1.76611  3.03361  1.09630
 1 -0.03840  2.95004  0.70058
 1  2.02213  0.59868  0.70713
 1  1.31572  0.88093  3.10750
 1 -2.36726 -1.10425  2.26373
 1 -1.99171 -0.94809 -0.19249
 1 -1.73365  0.06107  4.48630
 1 -0.00000  0.00000  4.83320
 1 -0.87544 -1.47713  4.40873

# -290651.4501195290025
 6  0.00819  0.00864 -0.00006
 8  0.20066  0.06604 -1.25632
 6  0.29201  2.18714 -1.83302
 6  1.29209  2.64330 -1.01368
 6  0.98221  2.72743  0.38986
 6  0.95189  0.60729  0.97645
 6  0.61711  0.46761  2.37222
 6 -1.23742 -0.55595  0.51358
 6 -0.51204 -0.18433  2.74710
 6 -1.44819 -0.64811  1.84921
 6 -0.78935 -0.40744  4.18758
 1 -0.76975  2.30228 -1.57521
 1  0.48295  2.01772 -2.89682
 1  2.34013  2.70290 -1.33735
 1  1.75864  3.03408  1.09442
 1 -0.04608  2.94003  0.70206
 1  2.02856  0.58934  0.71302
 1  1.32950  0.87102  3.10949
 1 -2.37372 -1.09052  2.25074
 1 -1.98774 -0.92823 -0.20346
 1 -1.73291  0.06690  4.48795
 1 -0.00136 -0.01098  4.84195
 1 -0.88801 -1.47851  4.40759

# -290648.2110411519183
 6 -0.00821 -0.00873 -0.00001
 8  0.18946  0.04979 -1.25540
 6  0.30822  2.20981 -1.83660
 6  1.31022  2.65290 -1.01246
 6  0.99616  2.73680  0.39016
 6  0.94052  0.61562  0.97110
 6  0.59915  0.47602  2.36528
 6 -1.24378 -0.58290  0.52708
 6 -0.52394 -0.18896  2.73546
 6 -1.44321 -0.66835  1.86489
 6 -0.78495 -0.40474  4.18010
 1 -0.75316  2.33590 -1.58235
 1  0.50117  2.04105 -2.90014
 1  2.36003  2.70185 -1.33217
 1  1.77332  3.03312  1.09833
 1 -0.03088  2.95984  0.69920
 1  2.01573  0.60789  0.70126
 1  1.30195  0.89066  3.10552
 1 -2.36089 -1.11773  2.27656
 1 -1.99568 -0.96780 -0.18160
 1 -1.73416  0.05542  4.48470
 1  0.00144  0.01108  4.82429
 1 -0.86275 -1.47548  4.40984

# -290650.0129973430987
 6  0.01473  0.03987  0.00353
 8  0.20971  0.14870 -1.24841
 6  0.31476  2.31103 -1.74004
 6  1.31586  2.72688 -0.90075
 6  1.00391  2.75389  0.50460
 6  0.96082  0.61125  1.00181
 6  0.62276  0.41512  2.38999
 6 -1.23103 -0.55449  0.48200
 6 -0.50336 -0.25796  2.73548
 6 -1.45210 -0.70505  1.81064
 6 -0.77324 -0.53593  4.16781
 1 -0.74067  2.55026 -1.55058
 1  0.50668  2.18525 -2.80970
 1  2.37998  2.61686 -1.15026
 1  1.78076  3.02642  1.22260
 1 -0.02375  2.95898  0.82381
 1  2.03685  0.60934  0.73515
 1  1.33037  0.79386  3.14474
 1 -2.37775 -1.17040  2.18504
 1 -1.96707 -0.89805 -0.26361
 1 -1.72043 -0.08241  4.48823
 1  0.00925 -0.15729  4.83036
 1 -0.86034 -1.61522  4.34914

# -290651.1441459119181
 6  0.02291  0.04845  0.00384
 8  0.21532  0.15674 -1.24855
 6  0.30661  2.29950 -1.73869
 6  1.30667  2.72207 -0.90151
 6  0.99678  2.74916  0.50428
 6  0.96651  0.60697  1.00435
 6  0.63173  0.41075  2.39331
 6 -1.22783 -0.54066  0.47575
 6 -0.49741 -0.25590  2.74141
 6 -1.45464 -0.69440  1.80306
 6 -0.77533 -0.53740  4.17151
 1 -0.74985  2.53304 -1.54788
 1  0.49756  2.17340 -2.80849
 1  2.37100  2.61770 -1.15256
 1  1.77320  3.02699  1.22071
 1 -0.03152  2.94889  0.82485
 1  2.04325  0.59979  0.74069
 1  1.34410  0.78393  3.14634
 1 -2.38419 -1.15591  2.17251
 1 -1.96297 -0.87774 -0.27370
 1 -1.71969 -0.07679  4.49017
 1  0.00792 -0.16851  4.83865
 1 -0.87274 -1.61661  4.34798

# -290648.6767159288632
 6  0.00653  0.03119  0.00315
 8  0.20412  0.14062 -1.24834
 6  0.32292  2.32247 -1.74130
 6  1.32495  2.73168 -0.89985
 6  1.01090  2.75854  0.50503
 6  0.95520  0.61551  0.99931
 6  0.61383  0.41939  2.38667
 6 -1.23426 -0.56825  0.48816
 6 -0.50926 -0.26005  2.72954
 6 -1.44965 -0.71558  1.81809
 6 -0.77103 -0.53433  4.16408
 1 -0.73148  2.56725 -1.55321
 1  0.51587  2.19705 -2.81082
 1  2.38884  2.61613 -1.14780
 1  1.78807  3.02582  1.22464
 1 -0.01613  2.96886  0.82287
 1  2.03048  0.61876  0.72964
 1  1.31665  0.80360  3.14314
 1 -2.37141 -1.18464  2.19744
 1 -1.97117 -0.91823 -0.25360
 1 -1.72094 -0.08785  4.48635
 1  0.01067 -0.14596  4.82192
 1 -0.84784 -1.61356  4.35030

# -290650.4782328634153
 6  0.03692  0.03224 -0.01851
 8  0.22789  0.14797 -1.27046
 6  0.25569  2.31267 -1.76209
 6  1.24131  2.76399 -0.92279
 6  0.92668  2.78497  0.48205
 6  0.95380  0.64361  0.98588
 6  0.62047  0.44066  2.37422
 6 -1.19416 -0.61415  0.45570
 6 -0.47871 -0.27523  2.72041
 6 -1.41549 -0.77558  1.78302
 6 -0.75016 -0.57064  4.14895
 1 -0.80876  2.49723 -1.56222
 1  0.45317  2.19002 -2.83110
 1  2.30884  2.68847 -1.17058
 1  1.69308  3.08525  1.20021
 1 -0.10765  2.95692  0.79930
 1  2.03080  0.68421  0.72631
 1  1.31056  0.85091  3.12873
 1 -2.32928 -1.27911  2.13655
 1 -1.91293 -0.98441 -0.29397
 1 -1.72370 -0.16224  4.46151
 1  0.00662 -0.15786  4.82091
 1 -0.78817 -1.65346  4.32609

# -290651.3838545290761
 6  0.04482  0.04110 -0.01813
 8  0.23320  0.15616 -1.27053
 6  0.24790  2.30080 -1.76073
 6  1.23225  2.75884 -0.92359
 6  0.91967  2.78000  0.48172
 6  0.95965  0.63952  0.98845
 6  0.62961  0.43662  2.37758
 6 -1.19144 -0.60023  0.44945
 6 -0.47283 -0.27298  2.72636
 6 -1.41840 -0.76502  1.77540
 6 -0.75222 -0.57214  4.15258
 1 -0.81726  2.47964 -1.55947
 1  0.44441  2.17779 -2.82988
 1  2.29980  2.68899 -1.17293
 1  1.68547  3.08559  1.19827
 1 -0.11512  2.94656  0.80033
 1  2.03756  0.67489  0.73192
 1  1.32467  0.84152  3.13041
 1 -2.33616 -1.26481  2.12393
 1 -1.90950 -0.96401 -0.30406
 1 -1.72326 -0.15646  4.46332
 1  0.00568 -0.16902  4.82912
 1 -0.80050 -1.65533  4.32486

# -290649.3792127794087
 6  0.02901  0.02329 -0.01897
 8  0.22260  0.13973 -1.27045
 6  0.26350  2.32444 -1.76336
 6  1.25026  2.76912 -0.92187
 6  0.93352  2.78986  0.48251
 6  0.94802  0.64768  0.98334
 6  0.61138  0.44461  2.37086
 6 -1.19692 -0.62799  0.46186
 6 -0.48454 -0.27750  2.71445
 6 -1.41267 -0.78600  1.79051
 6 -0.74800 -0.56899  4.14529
 1 -0.80023  2.51460 -1.56490
 1  0.46199  2.20222 -2.83223
 1  2.31775  2.68806 -1.16808
 1  1.70043  3.08489  1.20230
 1 -0.10034  2.96708  0.79837
 1  2.02408  0.69339  0.72074
 1  1.29646  0.86011  3.12705
 1 -2.32250 -1.29316  2.14904
 1 -1.91636 -1.00466 -0.28396
 1 -1.72392 -0.16783  4.45976
 1  0.00763 -0.14660  4.81255
 1 -0.77576 -1.65131  4.32731
"""


import numpy as np
import io
import os

sio = io.StringIO(DATA)
data = np.loadtxt(sio)
data = data.reshape(9,23,4)




if os.path.isfile('qm.txt'):
    qm = np.loadtxt('qm.txt')

bo = False
for ndx,d in enumerate(data):
    if np.allclose(d,qm,rtol=0.001,atol=0.001):
        bo = True
        break

if bo:
    elec = [float(i.split()[1]) for i in DATA.split('\n') if i.strip().startswith('#')]
    charges = np.array(list(map(float,CHARGES.split())))
    charges = charges.reshape(9,23)
    with open('QM.charges','wt') as f:
        for i in charges[ndx]:
            f.write(f'{i}\n')
    with open('ELEC.energy','wt') as f:
        f.write(f'{elec[ndx]}\n')
    print('Emulator DONE')
else:
    print('BAD')





